#!/bin/bash

RTYPE=$1
RNAME=$2
IP=$3
ZONE=$4

while getoptions 'o:' OPTIONS; do
	case "$OPTIONS" in
		o) if [$RTYPE == A ]
			then
				echo "Writing record"
				echo ";Name Server Records"		 >>/etc/bind/db.$ZONE
				echo "${NAME}	IN	A	${IP}"    >>/etc/bind/db.$ZONE
				echo "Yes, $RTYPE $NAME $ZONE"

		   elif [$RTYPE == MX ]
			then
				echo "Creating record"
				echo ";Name Server Records"		 >>/etc/bind/db.$ZONE
				echo "${NAME}   IN      A       ${IP}"    >>/etc/bind/db.$ZONE
				echo "Yes, $RTYPE $NAME $ZONE"
				echo "Writing mx record"
				echo ";Name Server MX"			>>/etc/bind/db.$ZONE
				echo "@ IN	MX	${NAME}.${ZONE}"  >>/etc/bind/db.$ZONE
		   elif [$RTYPE == CNAME ]
			then
				echo "Creating CNAME record"
				echo ";Name Server CNAME"		>>/etc/bind/db.$ZONE
				echo "${NAME}   IN      CNAME       ${IP}"    >>/etc/bind/db.$ZONE
				echo "Yes, $RTYPE $NAME $ZONE"
		   fi
	esac
done

last=$(grep "Serial" /etc/bind/db.$ZONE | tr -dc '0-9')
new=$((last + 1))
sed -i "s/.*Serial.*/\t\t        $new    ;Serial/g" /etc/bind/db.$ZONE

rndc reload
systemctl restart bind
